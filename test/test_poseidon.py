from pyseidon_t3 import poseidon_hash
from pyseidon_t3 import poseidon_hash_chain

poseidon3_ref = int(
  "0x115cc0f5e7d690413df64c6b9662e9cf2a3617f2743245519e19607a4417189a", 16)

hash_chain_ref = int(
  "0x2760fbf6c5749a683f0613da48c2c377995ba710af3cb13182c8aba7fee0fec2", 16)

def test_poseidon_hash():
  assert poseidon3_ref == int(poseidon_hash('1', '2'))

def test_poseidon_hash_chain():
  initial_hash = \
    "0x223afab1f45147cd578dc38f9d8f653ea88bb0a13398d8937b461a1c9f72a9bd"

  values = [
    "7188264", "5577113", "4492975", "3902676", "6252057", "2413982", "3610731",
    "311674", "4144235", "6888771", "7141499", "2216331", "4800939", "5475840",
    "5122202", "6975430", "5952624", "3356617", "89116", "2102868", "1780433",
    "3546815", "6005284", "6096997", "6321546", "6550237", "3168169", "2916787",
    "3994793", "3017456", "4796152", "3480173", "4735289", "4964236", "4048447",
    "3944887", "5552266", "6239064", "2872718", "6210705", "7295687", "6509560",
    "3902985", "5469433", "4000842", "615188", "4677858", "3729073", "7601840",
    "2214620", "2849352", "3078127", "7445133", "2235635", "6767726", "420291",
    "3586376", "36305", "1746279", "651419", "47440", "1087029", "2781226",
    "630698", "4941254", "4267017", "777898", "5238844", "4028654", "6361243",
    "86591", "1029914", "5168490", "1693910", "1018777", "5579843", "5536367"
  ]

  assert hash_chain_ref == int(poseidon_hash_chain(values, initial_hash))